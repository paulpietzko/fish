<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Feierabend Countdown</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #f0f0f0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  #movingImage {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    height: 150px;
  }
</style>
</head>
<body>

<img id="movingImage" src="./fish.png" alt="Feierabend Bild">

<script>
  // URL-Parameter auslesen
  const urlParams = new URLSearchParams(window.location.search);
  const feierabendParam = urlParams.get('feierabend'); // Format: HH:MM
  if(!feierabendParam) {
    alert("Bitte einen 'feierabend'-Parameter in HH:MM angeben!");
    throw new Error("Feierabend-Parameter fehlt");
  }

  const [hour, minute] = feierabendParam.split(':').map(Number);
  const now = new Date();
  const feierabendTime = new Date();
  feierabendTime.setHours(hour, minute, 0, 0);

  if(feierabendTime < now) {
    alert("Die angegebene Feierabend-Zeit liegt in der Vergangenheit!");
    throw new Error("Feierabend-Zeit in der Vergangenheit");
  }

  const image = document.getElementById('movingImage');
  const startX = window.innerWidth;
  const endX = -image.width;
  const totalDistance = startX - endX;

  const totalTime = feierabendTime - now; // Millisekunden bis Feierabend
  const speed = totalDistance / totalTime; // px/ms

  let posX = startX;
  let lastTime = performance.now();

  function animate(time) {
    const deltaTime = time - lastTime;
    lastTime = time;

    posX -= speed * deltaTime;
    if(posX < endX) posX = endX;
    image.style.left = posX + 'px';

    if(posX > endX) {
      requestAnimationFrame(animate);
    }
  }

  requestAnimationFrame(animate);
</script>

</body>
</html>
